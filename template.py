# requires: requests
# ^ –ï—Å–ª–∏ –≤–∞—à–µ–º—É –º–æ–¥—É–ª—é –Ω—É–∂–Ω—ã –±–∏–±–ª–∏–æ—Ç–µ–∫–∏, —É–∫–∞–∂–∏—Ç–µ –∏—Ö —Å–≤–µ—Ä—Ö—É —á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª

from .. import loader, utils

# –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
@loader.tds
class TemplateMod(loader.Module):
    """
    –®–∞–±–ª–æ–Ω–Ω—ã–π –º–æ–¥—É–ª—å.
    –ò–∑–º–µ–Ω–∏—Ç–µ —ç—Ç–æ—Ç —Ç–µ–∫—Å—Ç –Ω–∞ –æ–ø–∏—Å–∞–Ω–∏–µ –≤–∞—à–µ–≥–æ –º–æ–¥—É–ª—è.
    """
    
    # –£–Ω–∏–∫–∞–ª—å–Ω–æ–µ –∏–º—è –º–æ–¥—É–ª—è. 
    # –í–ù–ò–ú–ê–ù–ò–ï: –ï—Å–ª–∏ –æ–Ω–æ —Å–æ–≤–ø–∞–¥–µ—Ç —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º - –º–æ–¥—É–ª—å –Ω–µ –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è!
    strings = {
        "name": "MyTemplate", 
        "hello_world": "üëã <b>–ü—Ä–∏–≤–µ—Ç!</b> –Ø —Ä–∞–±–æ—Ç–∞—é.",
        "args_error": "üö´ <b>–û—à–∏–±–∫–∞:</b> –ù—É–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –∞—Ä–≥—É–º–µ–Ω—Ç—ã."
    }

    def __init__(self):
        # –ù–∞—Å—Ç—Ä–æ–π–∫–∏, –¥–æ—Å—Ç—É–ø–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —á–µ—Ä–µ–∑ .config
        self.config = loader.ModuleConfig(
            loader.ConfigValue(
                "default_reply", # –ò–º—è –∫–ª—é—á–∞
                "Just Works",    # –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
                "–û—Ç–≤–µ—Ç –∫–æ–º–∞–Ω–¥—ã .test", # –û–ø–∏—Å–∞–Ω–∏–µ
                validator=loader.validators.String()
            )
        )

    async def client_ready(self, client, db):
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–ª–∏–µ–Ω—Ç –∏ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
        self.client = client
        self.db = db

    @loader.command(alias="check") # –ú–æ–∂–Ω–æ –≤—ã–∑—ã–≤–∞—Ç—å –∫–∞–∫ .test –ò–ª–∏ .check
    async def testcmd(self, message):
        """<args> - –¢–µ—Å—Ç–æ–≤–∞—è –∫–æ–º–∞–Ω–¥–∞"""
        
        # –ü–æ–ª—É—á–∞–µ–º –∞—Ä–≥—É–º–µ–Ω—Ç—ã
        args = utils.get_args_raw(message)
        
        # –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥–∞
        reply_text = self.config["default_reply"]

        if args:
            # –ï—Å–ª–∏ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –µ—Å—Ç—å - –æ—Ç–≤–µ—á–∞–µ–º –∏–º–∏
            await utils.answer(message, f"–í—ã –Ω–∞–ø–∏—Å–∞–ª–∏: <code>{utils.escape_html(args)}</code>")
        else:
            # –ï—Å–ª–∏ –Ω–µ—Ç - –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç—Ä–æ–∫—É –∏–∑ translations
            await utils.answer(message, self.strings("hello_world"))
